<script>
    // Your specific config from image_587947.png
    const firebaseConfig = {
        apiKey: "AIzaSyBLLWB60iLX9SE6zCWHKYCvdzP51-fZEo8",
        databaseURL: "https://keysystem-b5fa5-default-rtdb.firebaseio.com/",
        projectId: "keysystem-b5fa5",
        appId: "1:898842570370:web:6987aeb9e3e50168e20e9b"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    async function getAndPurge() {
        const availRef = db.ref('vault/available_keys');
        const pendingRef = db.ref('vault/pending_redemption');

        const snapshot = await availRef.limitToFirst(1).once('value');
        if (snapshot.exists()) {
            const id = Object.keys(snapshot.val())[0];
            const code = snapshot.val()[id].code;

            document.getElementById('display').innerText = code;

            // Move to Pending & Remove from Available
            await pendingRef.push({ code: code, timestamp: Date.now() });
            await availRef.child(id).remove();
        }
    }
    window.onload = getAndPurge;
</script>
